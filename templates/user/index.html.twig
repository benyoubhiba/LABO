{% extends "base.html.twig" %}

{% block main%}

<main>
	<div class="container-fluid">
		<div class="row">
			<div class="col-12">
				<h1>Datatables Rows</h1>

				<div class="top-right-button-container">


					<nav class="breadcrumb-container d-none d-sm-block d-lg-inline-block" aria-label="breadcrumb">
						<ol class="breadcrumb pt-0">
							<li class="breadcrumb-item">
								<a href="#">Home</a>
							</li>
							<li class="breadcrumb-item">
								<a href="#">Library</a>
							</li>
							<li class="breadcrumb-item active" aria-current="page">Data</li>
						</ol>
					</nav>
					<div class="mb-2">
						<a class="btn pt-0 pl-0 d-inline-block d-md-none" data-toggle="collapse" href="#displayOptions" role="button" aria-expanded="true" aria-controls="displayOptions">
							Display Options
							<i class="simple-icon-arrow-down align-middle"></i>
						</a>
						<div class="collapse dont-collapse-sm" id="displayOptions">
							<div class="d-block d-md-inline-block">
								<div class="search-sm d-inline-block float-md-left mr-1 mb-1 align-top">
									<input class="form-control" placeholder="Search Table" id="searchDatatable">
								</div>
							</div>


							{# ajouter #}
							<div class="float-md-right dropdown-as-select" id="edit">{{ form_start(form) }}
								<div class="btn-group">
									<button type="button" class="btn btn-outline-primary" data-toggle="modal" data-backdrop="static" data-target="#exampleModalRight">Add</button>
								</div>
								<div class="modal fade modal-right" id="exampleModalRight" tabindex="-1" role="dialog" aria-labelledby="exampleModalRight" aria-hidden="true">
									<div class="modal-dialog" role="document">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title">Add New</h5>
												<button type="button" class="close" data-dismiss="modal" aria-label="Close">
													<span aria-hidden="true">&times;</span>
												</button>
											</div>
											<div class="modal-body">


												<div class="form-group">

													<label class="form-group has-float-label mb-4">
														{{ form_row(form.username,{'attr':{'class':'form-control'}}) }}
													</label>
												</div>

												<div class="form-group">
													<label class="form-group has-float-label mb-4">
														{{ form_row(form.email,{'attr':{'class':'form-control'}}) }}
													</label>
												</div>
												<div class="form-group">
													<label class="form-group has-float-label mb-4">
														{{ form_row(form.cin,{'attr':{'class':'form-control'}}) }}
													</label>
													<div class="form-group">
														<label class="form-group has-float-label mb-4">
															{{ form_row(form.phone,{'attr':{'class':'form-control'}}) }}
														</label>
													</div>
													<div class="form-group">
														<label class="form-group has-float-label mb-4">
															{{ form_row(form.password,{'attr':{'class':'form-control'}}) }}
														</label>
													</div>

												</div>
												<div class="modal-footer">
													<button type="button" class="btn btn-outline-primary" data-dismiss="modal">Cancel</button>
													<button type="submit" class="btn btn-primary">Submit</button>
												</div>

											</div>
										</div>
										{{ form_end(form) }}

									</div>
									{# fin_modal_ajouter #}
								</div>
							</div>
						</div>
						<div class="separator"></div>


						<div class="col-12 mb-4 data-table-rows data-tables-hide-filter">
							<div id="datatableRows_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4 no-footer">
								<div class="row view-filter">
									<div class="col-sm-12">
										<div class="float-left"></div>
										<div class="float-right">
											<div id="datatableRows_filter" class="dataTables_filter">
												<label>Search:<input type="search" class="form-control form-control-sm" placeholder="" aria-controls="datatableRows"></label>
											</div>
										</div>
										<div class="clearfix"></div>
									</div>

								</div>
								<table id="datatableRows" class="data-table responsive nowrap dataTable no-footer dtr-inline" data-order="[[ 1, &quot;desc&quot; ]]" role="grid" style="width: 1141px;">
									<thead>
										<tr>
											<th>Id</th>
											<th>Nom</th>
											<th>Cin</th>
											<th>email</th>

											<th>action</th>
											<th class="empty">&nbsp;</th>
										</tr>
									</thead>
									<tbody>
										{%for user in user %}
											<tr>
												<td>
													<p class="list-item-heading">{{user.id}}</p>
												</td>
												<td>
													<p class="text-muted">{{user.username}}</p>
												</td>
												<td>
													<p class="text-muted">{{user.cin}}</p>
												</td>
												<td>
													<p class="text-muted">{{user.email}}</p>
												</td>

												<td>
													<a href="{{path('user_show',{id:user.id})}}" data-toggle="modal" data-target="#show-{{user.id}}" class="btn  btn-warning">show</a>


													<div class="modal fade" id="show-{{user.id}}" tabindex="-1" role="dialog" aria-hidden="true">
														<div class="modal-dialog" role="document">
															<div class="modal-content">
																<div class="modal-header">
																	<h5 class="modal-title" id="exampleModalLabel">Show User</h5>
																	<button type="button" class="close" data-dismiss="modal" aria-label="Close">
																		<span aria-hidden="true">&times;</span>
																	</button>
																</div>
																<div class="modal-body">

																	<div class="col-md-6">
																		<label for="inputEmail4" class="form-label">Id
																		</label>
																		<p>{{user.id}}</p>
																		<p></p>
																	</div>
																	<div class="col-md-6">
																		<label for="inputPassword4" class="form-label">Cin
																		</label>
																		<p>{{user.cin}}</p>
																	</div>
																	<div class="col-12">
																		<label for="inputAddress" class="form-label">
																			Nom</label>
																		<p>{{user.username}}</p>
																	</div>
																	<div class="col-12">
																		<label for="inputAddress" class="form-label">
																			Email
																		</label>
																		<p>{{user.email}}</p>
																	</div>

																</div>

															</div>
														</div>
													</div>
												</td>

												<td>
													<a href="{{path('user_delete',{id:user.id})}}" class="btn  btn-danger" onclick="if(!confirm('Are you sure ?')) { return false; }">
														Delete</a>
												</td>
												<td>


													<div class="float-md-right dropdown-as-select" id="edit">
														<div class="btn-group">
															<a onclick="getInfo({{user.id}})" href="{{path('user_edit',{id:user.id})}}" data-toggle="modal" data-backdrop="static" data-target="#edit-{{user.id }}" class="load-popup">edit</a>

														</div>
														<div class="modal fade modal-right" id="edit-{{user.id }}" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true">

															<div class="modal-dialog" role="document">
																<div class="modal-content">
																	<div class="modal-header">
																		<h5 class="modal-title">Add New</h5>
																		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
																			<span aria-hidden="true">&times;</span>
																		</button>
																	</div>
																	<div class="modal-body">
																		<form id="update_form">

																			<div class="form-group">
																				<input class="form-group has-float-label mb-4" id="username_u" name="username" value="{{user.username}}">

																			</input>
																			<input class="form-group has-float-label mb-4" id="email_u" name="email" value="{{user.email}}">

																		</input>
																		<input class="form-group has-float-label mb-4" id="cin_u" name="phone" value="{{user.cin}}">


																	</div>
																</div>
																<div class="modal-footer">
																	<button type="button" class="btn btn-outline-primary" data-dismiss="modal">Cancel</button>
																	<button type="submit" class="btnS btn-primary" id="update">update</button>
																</div>
															</form>
														</div>

													</div>
												</td>
											</tr>
										</div>
										{# fin_modal_ajouter #}
									</tbody>
								</td>
								<td>
								<p data-placement="top" data-toggle="tooltip" title="Edit">
										<button onclick="getinfo({{user.id}})" class="btn edit btn-success" data-toggle="modal" data-target="#exampleModalRight"value="{{user.id}}">modifier</button>
									</p>
									

	
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div></div></main>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.26.1/axios.min.js" integrity="sha512-bPh3uwgU5qEMipS/VOmRqynnMXGGSRv+72H/N260MQeXZIK4PG48401Bsby9Nq5P5fz7hy5UGNmC/W1Z51h2GQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
	function getinfo(id){
		event.preventDefault();
		axios.get("/getInfouser/"+id).then(function (response) {
			let data = response.data
		
			$("#section_username").val(data.username)
			$("#hiddenId").val(id)
			
		}).catch(function (error) {
			console.log(error.request.response)
		})
	}
	function modifieruser(){
		event.preventDefault();
		let form = {
			"id":$("#hiddenId").val(),
		
			"username":$("#section_username").val(),
			
		}
		
		axios.post("/modifieruser",form).then(function (response) {
			alert(response.data)
		}).catch(function (error) {
			alert(error.request.response)
		})
	}
	</script>

		{# <script>
			$(document).ready(function(){
              $(document).on('click','#edit',function(){
                 var s_id = $(this).val();
				 
                  });
               });
            });
		</script> #}
{% endblock main %}
